apply plugin:'groovy'
apply plugin:'war'
apply plugin:'jetty'
apply plugin:'eclipse'
apply plugin:'eclipse-wtp'

repositories { maven { url "http://repo1.maven.org/maven2/" } }

sourceSets { integrationTest }

httpPort = 8163
stopPort = 9451
stopKey = 'foo'

[jettyRun, jettyRunWar]*.daemon = true

task integrationTest(type: Test, dependsOn: jettyRun) {
	testClassesDir = sourceSets.integrationTest.output.classesDir
	classpath = sourceSets.integrationTest.runtimeClasspath
	jettyStop.execute()
}

check.dependsOn integrationTest

task wrapper(type:Wrapper) { gradleVersion = '1.6' }

def springVersion = '3.2.3.RELEASE'

dependencies {
	compile "org.codehaus.groovy:groovy-all:2.1.4"
	providedCompile 'javax.servlet:servlet-api:2.5'

	testCompile "org.springframework:spring-context:$springVersion"
	testCompile "org.springframework:spring-web:$springVersion"
	testCompile "org.springframework:spring-tx:$springVersion"
	testCompile "org.springframework:spring-test:$springVersion"

	testCompile "junit:junit:4.11"

	integrationTestCompile 'junit:junit:4.11',
			sourceSets.main.output,
			sourceSets.test.output,
			configurations.testCompile
	integrationTestRuntime configurations.testRuntime
}
